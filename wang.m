clear all; close all
%% ??????A???????D?????????????L??
%% ?????????
n = 5; %% ???????????
A = [ 0 1 0 1 1;
         1 0 1 0 0;
         0 1 0 0 1;
         1 0 0 0 1;
         1 0 1 1 0;];
     %% ???23??????
 A2 = [ 0 0 1 1 1;
         0 0 1 0 1;
          0 0 0 1 1;
        1 0 0 0 1;
         1 1 0 1 0;];
          %% ???24??????
 A3 = [ 0 1 0 1 1;
          1 0 0 0 1;
           0 0 0 1 1;
         1 0 1 0 0;
         1 1 1 0 0;];
%  A = ones(n);
 diag_D = sum(A);
 D = diag(diag_D);
 L = D - A;
 
 [Ua,Va]=eig(A);
 %% ??A??????????????????????????????????????????????
 %% U(:,end)' = 0.5299    0.3578    0.3578    0.4271    0.5299
 %% ???????????3        2              2               2           3
 %% ???????âÿ?????????????4??????2?????????????????????
%% A ???2??3?????????????????????????????????????????????????????????????????ß“Å£
%% A ???2??3?????????????????????????24?????????????ß“Å£??

[Ul, Vl]=eig(L);
%% ??L???????????????ß≥??????0??
%% We denote the entire spectrum?????????ß≥????
%% ?????âÿ???????ß≥????????ß‡????????????
%% ?????????????ß≥??????0???????????????1/sqrt(N);
%% ????????????????????????
%% ???????????????????????????????ª«23??15??????????????????????????

%% ???????????
for ii = 1 : n
    ul = Ul(:, ii);
    Num_cross_zero(ii) = 0;
    for kk = 1 : n
        for jj = 1 : n
            if A(kk,jj) > 0
                Num_cross_zero(ii) = Num_cross_zero(ii) + (ul(kk) * ul(jj) <0) ;
            end
        end
    end
end
figure,plot(Num_cross_zero)


%% ????????????????????????????f(i), i = 1,..., n, n???ßﬂ??????
%% f' * L * f >= 0.
f = randn(n,1);
f'*L*f;
% f = rand(n,1);f'*L*f

%% ???????»Œ??f_hat = U' * f
%% ????????»Œ??f = U * f_hat
f = randn(n,1);
f(end) = 5;
f_gf = Ul * inv(eye(n) + 0.1* Vl) * Ul' * f

%% ??????????????
k = 2;
Als = zeros(n,k);
for ii = 1 : k
    Als(:, ii) = L^(ii-1) * f;
end

bls = f - 0.1* L * f;
Theta = pinv(Als) * bls;
f_gfk = 0;
for ii = 1 : k
    f_gfk = f_gfk + Theta(ii) * L^(ii-1) * f;
end
f'*L*f
f_gf'*L*f_gf
f_gfk'*L*f_gfk
f, f_gf, f_gfk
